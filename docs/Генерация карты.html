<!DOCTYPE html>
<html lang = "ru">
    <head>
        <meta charset = "utf-8">
        <title>Генерация карты</title>
    </head>
    <body>
        <h1>Генерация карты</h1>

        <p><span style="color:#0000ff">Находится в</span>: <strong>generateMap.py</strong>;</p>

        <p><span style="color:#0000ff">Использует</span>: <strong>OstTree.py</strong>,&nbsp;<strong>classPlanet.py</strong>,&nbsp;<strong>classStar.py</strong>, <strong>mymath.py</strong>, <strong>DNS.py</strong> <em>(подключается к <strong>OstTree.py</strong>), </em><strong>StarsNames.txt, PlanetsNames.txt;</strong></p>

        <p><span style="color:#0000ff">Время работы</span>: <strong>О(n<sup>2</sup>&nbsp;+ 2n + ~10 * m * n)</strong>, где <strong>n</strong> -- кол-во звёзд в генерируемой карте, а <strong>m</strong> -- максимальное количество планет у одной звезды, а <strong>~</strong> -- значок &quot;приблизительно равно&quot;, <em>ибо в этой части алгоритма используется <strong>очень лютый рандом</strong>, но если задать адекватное соотношение кол-ва планет, минимальной дистанции между ними и размеров планетарной карты, то число будет гарантированно меньше десяти (читай далее);</em></p>

        <p>В файле <strong>generateMap.py</strong> находится тестовый пример генерации карты (<strong>if __name__ == &quot;__main__&quot;</strong>), который создаёт карту с определёнными характеристиками (см. далее) и выводит её. Пример пока стирать не рекомендуется, ибо ещё не описаны полностью классы планеты и звезды --&gt; надо будет проводить ещё тесты --&gt; нужны готовые примеры.</p>

        <p>Функции, которые можно использовать извне(остальные -- технические):</p>

        <hr />
        <p><strong>generateMap(n, minp, maxp, minl, maxl, size, mind) : [[Star], [Planet]].&nbsp;</strong>Пояснение: возвращается двумерный массив, где первый элемент -- массив объектов класса Star (см. Классы), а второй -- массив объектов класса Planet (см. Классы). Параметры функции следующие:</p>

        <ul>
            <li><strong>n</strong> : <strong>int</strong> -- кол-во звёзд в генерируемой системе (не больше 324: во-первых, ровно столько готовых названий для звёзд существует на данный момент (см. далее); во-вторых, обратите внимание на время работы алгоритма;</li>
            <li><strong>minp</strong> : <strong>int</strong> -- минимальное кол-во планет в одной системе;</li>
            <li><strong>maxp</strong> : <strong>int</strong> -- максимальное кол-во планет в одной системе (<strong>maxp</strong> * <strong>n</strong> не больше, чем 196, ибо ровно столько готовых названий для планет существует на данный момент);</li>
            <li><strong>minl</strong> : <strong>int</strong> -- минимальная длина пути между двумя звёздами;</li>
            <li><strong>maxl</strong> : <strong>int</strong> -- максимальная длина пути между двумя звёздами (разброс с минимальной роли не играет: вероятность выпадения любого числа из промежутка [<strong>minl</strong>; <strong>maxl</strong>] примерно одинаковая);</li>
            <li><strong>size</strong> : <strong>int</strong>-- размер квадратного (пока) поля каждой звезды, на котором отмечены координатой (<strong>x</strong>; <strong>y</strong>) планеты; ещё это поле называется <em>планетарным</em>;</li>
            <li><strong>mind</strong> : <strong>int</strong> -- минимальное расстояние между двумя планетами в клетках; <em>вычисляется по Пифагору</em>;</li>
        </ul>

        <hr />
        <p><strong>printSystems(systems, size)</strong> : <strong>None</strong>. Выводит карту в терминал. Параметры процедуры следующие:</p>

        <ul>
            <li><strong>systems</strong> : <strong>[[Star], [Planet]]</strong> -- выводимая карта в том формате, в котором её сгенерировала <strong>generateMap</strong>;</li>
            <li><strong>size</strong> : <strong>int</strong> -- размер планетарного поля для данной карты;</li>
        </ul>

        <hr />
        <h2>Содержание используемых файлов:</h2>

        <ul>
            <li><span style="color:#0000CD"><strong>OstTree.py -- </strong></span><span style="color:#000000">реализация алгоритма Краскала с небольшой модификацией (описана ниже);</span></li>
            <li><span style="color:#0000CD"><strong>classPlanet.py -- </strong></span><span style="color:#000000">класс планеты (см. <strong>Классы</strong>);</span></li>
            <li><span style="color:#0000CD"><strong>classStar.py -- </strong></span><span style="color:#000000">класс звезды (см. <strong>Классы</strong>);</span></li>
            <li><span style="color:#0000CD"><strong>mymath.py --</strong> </span><span style="color:#000000">реализация весьма специфичных математических функций;</span></li>
            <li><span style="color:#0000CD"><strong>DNS.py --</strong></span><span style="color:#000000"><strong> </strong>реализация структуры данных СНМ <em>(Система Непересекающихся множеств)</em>;</span></li>
            <li><span style="color:#0000CD"><strong>StarsNames.txt -- </strong></span><span style="color:#000000">список возможных названий для звёзд (может быть расширен);</span></li>
            <li><span style="color:#0000CD"><strong>PlanetsNames.txt -- </strong></span><span style="color:#000000">список возможных названий для планет (может быть расширен);</span></li>
        </ul>

        <hr />
        <h2>Где улучшать создание планеты и звезды</h2>

        <p>В функциях <strong>generatePlanets</strong> и <strong>generateConstellation</strong>, там есть комментарий, где начинается создание планеты и звезды. На данный момент там генерируется только имя и координаты (для планеты), а остальная генерация планеты происходит в <b>classPlanet.py</b> при создании объекта класса <b>Planet</b> (см. функцию <b>newPlanet(name, (x, y))</b>).</p>

        <hr />
        <h2>Принцип работы алгоритма</h2>

        <p>Маловероятно, что кто-то будет это читать, но всё же. Вдруг придётся улучшать алгоритм?</p>

        <p>Генерируется <strong>n</strong> звёзд, между ними создаётся <strong>n</strong><sup>2</sup>&nbsp;путей случайной длины. Далее они перемешиваются в случайном порядке и по алгоритму Краскала строится дерево (только вместо сортировки используется перемешивание, а вместо остовного дерева получается дерево общего вида, что и требуется для игры). Созвездия сгенерировались. Планеты создаются простейшим образом -- рандомом. Выбирается кол-во планет у звезды. Выбираются такие x и y, что стоят на достаточном расстоянии от координат других планет. Выбирается название из списка доступных, меняется местами с последним, длина списка уменьшается на один (т.к. изменение длины списка в <em>python3</em> весьма затратно, то меняется отдельная переменная (<strong>namesNumber</strong>), которая определяет, какой элемент списка является последним. Точно также выбирается название для звёзд. Остальное происходит в модуле <b>classPlanet</b>, где определен класс планеты. Ещё стоит заметить следующие моменты:</p>

        <ul>
            <li>Названия планет и звёзд подгружаются в одну и ту же переменную <strong>Names</strong>;</li>
            <li>Кол-во звёзд у планеты определяется при генерации планет, а потом уже заносится в поле звезды;</li>
        </ul>

        <hr />
    </body>
</html>
